<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>✦ THE GALLERY ✦</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,700;1,400;1,500&family=Inter:wght@200;300;400;500&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&display=swap');

        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

        :root{
            --expo:cubic-bezier(0.16,1,0.3,1);
            --spring:cubic-bezier(0.34,1.56,0.64,1);
            --smooth:cubic-bezier(0.25,0.46,0.45,0.94);
            --fg:#000;
            --bg:#fff;
            --sub:rgba(0,0,0,0.06);
            --mut:rgba(0,0,0,0.12);
            --soft:rgba(0,0,0,0.2);
            --med:rgba(0,0,0,0.35);
            --txt:rgba(0,0,0,0.5);
            --f-disp:'Playfair Display',serif;
            --f-body:'Inter',sans-serif;
            --f-acc:'Cormorant Garamond',serif;
        }

        html{overflow:hidden;height:100%}

        body{
            background:var(--bg);height:100%;overflow:hidden;
            font-family:var(--f-body);cursor:none;
            user-select:none;-webkit-user-select:none;
            -webkit-tap-highlight-color:transparent;
        }

        /* ==========================================
           CURSOR
           ========================================== */
        .cur-ring{
            width:22px;height:22px;border:1.5px solid rgba(0,0,0,0.25);
            border-radius:50%;position:fixed;pointer-events:none;z-index:100000;
            transform:translate(-50%,-50%);mix-blend-mode:difference;
            transition:width .3s ease,height .3s ease,background .3s ease,
            border-color .3s ease,border-style .2s ease,opacity .3s ease;
        }
        .cur-ring.hov{width:55px;height:55px;background:rgba(0,0,0,0.04);border-color:rgba(0,0,0,0.45)}
        .cur-ring.grab{width:42px;height:42px;background:rgba(0,0,0,0.08);border-color:rgba(0,0,0,0.55);border-style:dashed}
        .cur-ring.zoom{width:50px;height:50px;border-color:rgba(0,0,0,0.2);background:rgba(0,0,0,0.02)}
        .cur-ring.nav{width:60px;height:60px;background:rgba(0,0,0,0.02);border-color:rgba(0,0,0,0.3)}
        .cur-dot{
            width:4px;height:4px;background:var(--fg);border-radius:50%;
            position:fixed;pointer-events:none;z-index:100001;transform:translate(-50%,-50%);
        }
        .cur-lbl{
            position:fixed;pointer-events:none;z-index:100002;
            font-family:var(--f-body);font-size:.48rem;letter-spacing:3px;
            text-transform:uppercase;color:rgba(0,0,0,0.4);
            transform:translate(22px,-50%);opacity:0;transition:opacity .25s ease;
            white-space:nowrap;
        }
        .cur-lbl.on{opacity:1}

        .trail{
            position:fixed;width:3px;height:3px;background:rgba(0,0,0,0.05);
            border-radius:50%;pointer-events:none;z-index:99999;
            animation:trailDie .65s ease forwards;
        }
        @keyframes trailDie{to{opacity:0;transform:scale(0) translateY(-8px)}}

        .ripple{
            position:fixed;border-radius:50%;pointer-events:none;z-index:99998;
            border:1px solid rgba(0,0,0,0.05);animation:ripGrow .7s var(--expo) forwards;
        }
        @keyframes ripGrow{0%{width:0;height:0;opacity:1}100%{width:180px;height:180px;opacity:0}}

        /* ==========================================
           LOADER
           ========================================== */
        .loader{
            position:fixed;inset:0;background:var(--bg);z-index:50000;
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            transition:opacity 1s var(--expo),transform 1s var(--expo);
        }
        .loader.done{opacity:0;transform:scale(1.04);pointer-events:none}
        .loader h1{
            font-family:var(--f-disp);font-size:2rem;font-weight:400;
            letter-spacing:18px;text-transform:uppercase;color:var(--fg);
            margin-bottom:8px;opacity:0;animation:lfu 1s ease forwards .2s;
        }
        .loader .tag{
            font-family:var(--f-acc);font-size:.9rem;font-style:italic;
            font-weight:300;letter-spacing:4px;color:var(--soft);
            margin-bottom:55px;opacity:0;animation:lfu 1s ease forwards .4s;
        }
        .loader .track{
            width:200px;height:1px;background:var(--sub);overflow:hidden;
            opacity:0;animation:lfu 1s ease forwards .6s;
        }
        .loader .fill{height:100%;background:var(--fg);width:0%;transition:width .2s ease}
        .loader .pct{
            font-size:.6rem;font-weight:300;letter-spacing:6px;color:var(--soft);
            margin-top:20px;opacity:0;animation:lfu 1s ease forwards .8s;
        }
        .loader .cnt{
            font-size:.42rem;letter-spacing:4px;color:var(--mut);margin-top:8px;
            text-transform:uppercase;opacity:0;animation:lfu 1s ease forwards 1s;
        }
        @keyframes lfu{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

        /* ==========================================
           INTRO SPLASH
           ========================================== */
        .intro{
            position:fixed;inset:0;background:var(--bg);z-index:40000;
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            opacity:0;pointer-events:none;transition:opacity .8s ease;
        }
        .intro.on{opacity:1;pointer-events:all}
        .intro.bye{opacity:0;pointer-events:none;transition:opacity 1.2s var(--expo)}
        .intro .big{
            font-family:var(--f-disp);font-size:clamp(2.5rem,8vw,7rem);
            font-weight:400;letter-spacing:20px;text-transform:uppercase;
            color:rgba(0,0,0,0.06);opacity:0;transform:translateY(45px) scale(.96);
            transition:opacity 1.2s ease .2s,transform 1.2s var(--expo) .2s;
        }
        .intro.on .big{opacity:1;transform:translateY(0) scale(1)}
        .intro .sub{
            font-size:.55rem;letter-spacing:8px;text-transform:uppercase;color:var(--soft);
            margin-top:28px;opacity:0;transform:translateY(12px);
            transition:opacity 1s ease .5s,transform 1s var(--expo) .5s;
        }
        .intro.on .sub{opacity:1;transform:translateY(0)}
        .intro .iline{
            width:1px;height:0;background:var(--mut);margin-top:35px;
            transition:height 1s var(--expo) .8s;
        }
        .intro.on .iline{height:65px}
        .intro .enter{
            font-family:var(--f-acc);font-size:.8rem;font-style:italic;
            letter-spacing:5px;color:var(--soft);cursor:none;
            padding:12px 28px;border:1px solid var(--sub);border-radius:30px;
            margin-top:28px;transition:all .4s ease;
            opacity:0;transform:translateY(12px);background:none;
        }
        .intro.on .enter{opacity:1;transform:translateY(0);transition-delay:1.1s}
        .intro .enter:hover{border-color:var(--soft);background:rgba(0,0,0,0.02);letter-spacing:7px}

        /* ==========================================
           TOP BAR
           ========================================== */
        .topbar{
            position:fixed;top:0;left:0;right:0;height:70px;z-index:500;
            display:flex;align-items:center;justify-content:space-between;
            padding:0 40px;
            background:linear-gradient(to bottom,rgba(255,255,255,.97) 0%,rgba(255,255,255,.7) 60%,transparent 100%);
            pointer-events:none;opacity:0;transform:translateY(-12px);
            transition:opacity .8s ease .3s,transform .8s var(--expo) .3s;
        }
        .topbar.on{opacity:1;transform:translateY(0)}
        .topbar .brand{font-family:var(--f-disp);font-size:.7rem;letter-spacing:7px;color:var(--mut);text-transform:uppercase}
        .topbar .center{position:absolute;left:50%;transform:translateX(-50%);text-align:center}
        .topbar .title{font-family:var(--f-disp);font-size:.72rem;font-weight:500;letter-spacing:3px;color:var(--soft);display:block}
        .topbar .cat{font-family:var(--f-acc);font-size:.58rem;font-style:italic;font-weight:300;letter-spacing:2px;color:var(--mut);display:block;margin-top:1px}
        .topbar .meta{display:flex;align-items:center;gap:18px}
        .topbar .keys{font-size:.4rem;letter-spacing:3px;color:var(--mut);text-transform:uppercase}
        .topbar .ctr{font-size:.48rem;letter-spacing:4px;color:var(--mut);font-variant-numeric:tabular-nums}

        .page-prog{position:fixed;top:0;left:0;height:2px;background:linear-gradient(90deg,rgba(0,0,0,.04),rgba(0,0,0,.15),rgba(0,0,0,.04));z-index:501;width:0%;transition:width .6s var(--expo)}

        /* ==========================================
           3D STAGE
           ========================================== */
        .stage{
            position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
            perspective:1500px;perspective-origin:50% 50%;
            opacity:0;transition:opacity 1s ease;
        }
        .stage.on{opacity:1}
        .scene{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;transform-style:preserve-3d}

        /* ==========================================
           SLIDES
           ========================================== */
        .slide{
            position:absolute;transform-style:preserve-3d;will-change:transform,opacity;
            transition:transform 1s var(--expo),opacity .8s ease,filter .8s ease;
        }
        .slide.active{opacity:1;z-index:20;filter:none}
        .slide.p1{opacity:.3;z-index:15;filter:blur(1.5px) brightness(.98);pointer-events:none}
        .slide.n1{opacity:.3;z-index:15;filter:blur(1.5px) brightness(.98);pointer-events:none}
        .slide.p2{opacity:.1;z-index:10;filter:blur(3px) brightness(.95);pointer-events:none}
        .slide.n2{opacity:.1;z-index:10;filter:blur(3px) brightness(.95);pointer-events:none}
        .slide.far{opacity:0;z-index:1;pointer-events:none}

        /* ==========================================
           CARD (3D transformable)
           ========================================== */
        .card{
            position:relative;transform-style:preserve-3d;border-radius:10px;
            transition:box-shadow .5s ease;
        }
        .slide.active .card{
            box-shadow:0 30px 80px rgba(0,0,0,.07),0 15px 40px rgba(0,0,0,.04),0 5px 15px rgba(0,0,0,.03);
        }
        .slide.active:hover .card{
            box-shadow:0 40px 100px rgba(0,0,0,.09),0 20px 50px rgba(0,0,0,.05),0 8px 20px rgba(0,0,0,.04);
        }
        .card-face{
            position:relative;border-radius:10px;overflow:hidden;
            backface-visibility:hidden;background:#f8f8f8;
        }
        .card-face::after{
            content:'';position:absolute;inset:0;border:1px solid rgba(0,0,0,.04);
            border-radius:10px;pointer-events:none;z-index:5;
        }
        .card-face img{
            display:block;max-width:72vw;max-height:75vh;border-radius:10px;
            pointer-events:none;filter:saturate(1.04) contrast(1.015);
            transition:filter .5s ease;
        }
        .slide.active:hover .card-face img{filter:saturate(1.1) contrast(1.03)}

        .card-shine{
            position:absolute;inset:0;
            background:linear-gradient(105deg,transparent 38%,rgba(255,255,255,.08) 42%,
            rgba(255,255,255,.2) 48%,rgba(255,255,255,.28) 50%,rgba(255,255,255,.2) 52%,
            rgba(255,255,255,.08) 58%,transparent 62%);
            pointer-events:none;z-index:3;opacity:0;transform:translateX(-130%);border-radius:10px;
        }
        .slide.active:hover .card-shine{animation:shineGo 1.5s ease forwards}
        @keyframes shineGo{0%{opacity:1;transform:translateX(-130%)}100%{opacity:1;transform:translateX(130%)}}

        .card-spec{
            position:absolute;inset:0;pointer-events:none;z-index:4;border-radius:10px;
            opacity:0;transition:opacity .4s ease;
            background:radial-gradient(circle at var(--sx,50%) var(--sy,50%),rgba(255,255,255,.14) 0%,transparent 50%);
        }
        .slide.active:hover .card-spec{opacity:1}

        .card-grad{
            position:absolute;bottom:0;left:0;right:0;height:35%;
            background:linear-gradient(to top,rgba(0,0,0,.04),transparent);
            pointer-events:none;z-index:2;border-radius:0 0 10px 10px;
        }

        .card-lbl{
            position:absolute;bottom:18px;left:22px;z-index:6;
            font-family:var(--f-body);font-size:.46rem;font-weight:400;
            letter-spacing:4px;text-transform:uppercase;
            color:rgba(255,255,255,.55);text-shadow:0 1px 6px rgba(0,0,0,.25);
            opacity:0;transform:translateY(8px);
            transition:opacity .5s ease,transform .5s var(--expo);
        }
        .slide.active:hover .card-lbl{opacity:1;transform:translateY(0)}

        .card-num{
            position:absolute;top:16px;right:20px;z-index:6;
            font-family:var(--f-body);font-size:.43rem;font-weight:300;
            letter-spacing:3px;color:rgba(255,255,255,.35);
            opacity:0;transition:opacity .5s ease;
        }
        .slide.active:hover .card-num{opacity:1}

        .card-shadow{
            position:absolute;bottom:-22px;left:8%;right:8%;height:35px;
            background:radial-gradient(ellipse at center,rgba(0,0,0,.05),transparent 70%);
            filter:blur(12px);z-index:-1;
        }

        .cbr{position:absolute;width:16px;height:16px;z-index:7;pointer-events:none;opacity:0;transition:opacity .4s ease .1s}
        .slide.active:hover .cbr{opacity:1}
        .cbr.tl{top:-6px;left:-6px;border-top:1px solid rgba(0,0,0,.15);border-left:1px solid rgba(0,0,0,.15)}
        .cbr.tr{top:-6px;right:-6px;border-top:1px solid rgba(0,0,0,.15);border-right:1px solid rgba(0,0,0,.15)}
        .cbr.bl{bottom:-6px;left:-6px;border-bottom:1px solid rgba(0,0,0,.15);border-left:1px solid rgba(0,0,0,.15)}
        .cbr.br{bottom:-6px;right:-6px;border-bottom:1px solid rgba(0,0,0,.15);border-right:1px solid rgba(0,0,0,.15)}

        /* ==========================================
           FULLSCREEN VIEWER (click to open)
           ========================================== */
        .viewer{
            position:fixed;inset:0;z-index:8000;
            background:rgba(255,255,255,.98);
            backdrop-filter:blur(30px);-webkit-backdrop-filter:blur(30px);
            display:flex;align-items:center;justify-content:center;
            opacity:0;pointer-events:none;
            transition:opacity .5s var(--expo);
        }
        .viewer.on{opacity:1;pointer-events:all}

        .viewer-close{
            position:fixed;top:25px;right:30px;z-index:8001;
            width:42px;height:42px;border:1px solid rgba(0,0,0,.08);
            border-radius:50%;background:rgba(255,255,255,.8);
            backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);
            display:flex;align-items:center;justify-content:center;
            font-size:17px;color:rgba(0,0,0,.35);cursor:none;
            transition:all .3s ease;
            opacity:0;pointer-events:none;
        }
        .viewer.on .viewer-close{opacity:1;pointer-events:all}
        .viewer-close:hover{background:rgba(0,0,0,.04);border-color:rgba(0,0,0,.18);color:rgba(0,0,0,.6)}

        .vp{
            width:90vw;height:90vh;overflow:hidden;cursor:grab;
            display:flex;align-items:center;justify-content:center;
            position:relative;
        }
        .vp:active{cursor:grabbing}

        .vp-container{
            transform-origin:center center;will-change:transform;
            display:flex;align-items:center;justify-content:center;
        }
        .vp-container.anim{transition:transform .4s var(--expo)}

        .vp-container img{
            max-width:85vw;max-height:85vh;border-radius:8px;
            pointer-events:none;filter:saturate(1.04) contrast(1.015);
        }

        /* zoom controls in viewer */
        .vz{
            position:fixed;bottom:30px;left:50%;
            transform:translateX(-50%) translateY(15px);
            display:flex;align-items:center;gap:12px;
            padding:9px 20px;background:rgba(255,255,255,.92);
            backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
            border:1px solid rgba(0,0,0,.04);border-radius:40px;
            box-shadow:0 4px 30px rgba(0,0,0,.03);z-index:8002;
            opacity:0;pointer-events:none;
            transition:opacity .4s ease,transform .4s var(--expo);
        }
        .viewer.on .vz{opacity:1;pointer-events:all;transform:translateX(-50%) translateY(0);transition-delay:.15s}

        .vz button{
            background:none;border:1px solid rgba(0,0,0,.07);
            width:30px;height:30px;border-radius:50%;font-size:15px;
            font-weight:300;color:var(--med);cursor:none;
            display:flex;align-items:center;justify-content:center;
            transition:all .25s ease;
        }
        .vz button:hover{background:rgba(0,0,0,.04);border-color:rgba(0,0,0,.15);color:var(--txt)}
        .vz button:active{transform:scale(.88)}
        .vz .pct{font-size:.55rem;font-weight:300;letter-spacing:2px;color:var(--soft);min-width:42px;text-align:center;font-variant-numeric:tabular-nums}
        .vz .sep{width:1px;height:14px;background:rgba(0,0,0,.05)}
        .vz .rst{width:auto;padding:0 13px;border-radius:16px;font-size:.43rem;letter-spacing:2px;text-transform:uppercase}

        /* minimap in viewer */
        .mm{
            position:fixed;bottom:85px;right:25px;width:110px;height:80px;
            border:1px solid rgba(0,0,0,.05);border-radius:5px;overflow:hidden;
            z-index:8002;background:var(--bg);box-shadow:0 4px 18px rgba(0,0,0,.02);
            opacity:0;pointer-events:none;transform:translateY(6px) scale(.95);
            transition:opacity .4s ease,transform .4s var(--expo);
        }
        .mm.on{opacity:1;transform:translateY(0) scale(1)}
        .mm img{width:100%;height:100%;object-fit:contain;opacity:.35;pointer-events:none}
        .mm-vp{position:absolute;border:1.5px solid rgba(0,0,0,.3);border-radius:2px;background:rgba(0,0,0,.03);pointer-events:none}

        /* image info panel in viewer */
        .viewer-info{
            position:fixed;top:28px;left:35px;z-index:8001;
            opacity:0;pointer-events:none;transition:opacity .5s ease .3s;
        }
        .viewer.on .viewer-info{opacity:1}
        .viewer-info .vi-title{font-family:var(--f-disp);font-size:.9rem;letter-spacing:4px;color:var(--soft)}
        .viewer-info .vi-cat{font-family:var(--f-acc);font-size:.65rem;font-style:italic;letter-spacing:2px;color:var(--mut);margin-top:3px}

        /* ==========================================
           NAV ZONES
           ========================================== */
        .nz{
            position:fixed;top:0;width:14%;height:100%;z-index:100;
            display:flex;align-items:center;cursor:none;
        }
        .nz.l{left:0;justify-content:flex-start;padding-left:25px}
        .nz.r{right:0;justify-content:flex-end;padding-right:25px}
        .nz-btn{
            width:46px;height:46px;border:1px solid rgba(0,0,0,.06);border-radius:50%;
            display:flex;align-items:center;justify-content:center;
            font-size:15px;font-weight:300;color:var(--soft);
            background:rgba(255,255,255,.7);backdrop-filter:blur(10px);
            opacity:0;transform:scale(.75);transition:all .4s var(--expo);
        }
        .nz:hover .nz-btn{opacity:1;transform:scale(1)}
        .nz:active .nz-btn{transform:scale(.88);background:rgba(0,0,0,.03)}

        /* ==========================================
           BOTTOM BAR
           ========================================== */
        .botbar{
            position:fixed;bottom:0;left:0;right:0;height:85px;z-index:500;
            display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;
            background:linear-gradient(to top,rgba(255,255,255,.97) 0%,rgba(255,255,255,.6) 60%,transparent 100%);
            pointer-events:none;opacity:0;transform:translateY(12px);
            transition:opacity .8s ease .4s,transform .8s var(--expo) .4s;
        }
        .botbar.on{opacity:1;transform:translateY(0)}

        .film{
            display:flex;gap:5px;align-items:center;pointer-events:all;
            padding:4px 8px;border-radius:8px;
            background:rgba(255,255,255,.5);backdrop-filter:blur(8px);
        }
        .ft{
            width:38px;height:26px;border-radius:4px;overflow:hidden;
            border:1.5px solid transparent;opacity:.3;cursor:none;
            transition:all .35s var(--expo);flex-shrink:0;
        }
        .ft.on{border-color:rgba(0,0,0,.25);opacity:1;transform:scale(1.15)}
        .ft:hover{opacity:.7;transform:scale(1.08)}
        .ft img{width:100%;height:100%;object-fit:cover;pointer-events:none;border-radius:2.5px}

        .dots{display:flex;gap:7px;align-items:center;pointer-events:all}
        .dot{
            width:5px;height:5px;border-radius:50%;background:var(--mut);
            cursor:none;transition:all .4s var(--expo);
        }
        .dot.on{width:20px;border-radius:3px;background:var(--med)}
        .dot:hover{background:var(--soft)}

        /* side badge */
        .badge{
            position:fixed;top:50%;right:28px;transform:translateY(-50%);z-index:200;
            display:flex;flex-direction:column;align-items:center;gap:5px;
            opacity:0;transition:opacity .8s ease .5s;
        }
        .badge.on{opacity:1}
        .badge-ln{width:1px;height:28px;background:var(--sub)}
        .badge-n{font-family:var(--f-disp);font-size:1.3rem;font-weight:300;color:var(--mut);line-height:1}
        .badge-t{font-size:.38rem;letter-spacing:3px;color:var(--mut);text-transform:uppercase}

        .catlbl{
            position:fixed;top:50%;left:28px;
            transform:translateY(-50%) rotate(-90deg);transform-origin:center;
            z-index:200;font-family:var(--f-body);font-size:.4rem;
            letter-spacing:6px;text-transform:uppercase;color:var(--mut);
            white-space:nowrap;opacity:0;transition:opacity .6s ease;
        }
        .catlbl.on{opacity:1}

        /* ==========================================
           FLASH
           ========================================== */
        .flash{
            position:fixed;inset:0;background:rgba(255,255,255,.35);
            pointer-events:none;z-index:30000;opacity:0;transition:opacity .12s ease;
        }
        .flash.go{opacity:1}

        /* ==========================================
           HELP OVERLAY
           ========================================== */
        .help{
            position:fixed;inset:0;background:rgba(255,255,255,.97);
            backdrop-filter:blur(20px);z-index:20000;
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            opacity:0;pointer-events:none;transition:opacity .4s ease;
        }
        .help.on{opacity:1;pointer-events:all}
        .help h2{font-family:var(--f-disp);font-size:1.1rem;letter-spacing:8px;text-transform:uppercase;color:var(--soft);margin-bottom:35px}
        .help-grid{display:grid;grid-template-columns:auto auto;gap:12px 35px}
        .help-k{font-size:.58rem;font-weight:500;letter-spacing:2px;color:var(--med);text-align:right;padding:4px 10px;background:rgba(0,0,0,.03);border-radius:4px}
        .help-d{font-size:.58rem;font-weight:300;letter-spacing:1px;color:var(--soft);display:flex;align-items:center}
        .help .close{
            margin-top:35px;font-family:var(--f-acc);font-size:.75rem;
            font-style:italic;letter-spacing:3px;color:var(--soft);cursor:none;
            padding:8px 24px;border:1px solid var(--sub);border-radius:20px;
            background:none;transition:all .3s ease;
        }
        .help .close:hover{border-color:var(--soft);background:rgba(0,0,0,.02)}

        /* ==========================================
           AMBIENT
           ========================================== */
        .amb{position:fixed;width:100px;height:100px;pointer-events:none;z-index:0;opacity:.2}
        .amb.tl{top:22px;left:22px;border-top:1px solid rgba(0,0,0,.03);border-left:1px solid rgba(0,0,0,.03)}
        .amb.tr{top:22px;right:22px;border-top:1px solid rgba(0,0,0,.03);border-right:1px solid rgba(0,0,0,.03)}
        .amb.bl{bottom:22px;left:22px;border-bottom:1px solid rgba(0,0,0,.03);border-left:1px solid rgba(0,0,0,.03)}
        .amb.br{bottom:22px;right:22px;border-bottom:1px solid rgba(0,0,0,.03);border-right:1px solid rgba(0,0,0,.03)}
        .ap{position:fixed;width:2px;height:2px;background:rgba(0,0,0,.03);border-radius:50%;pointer-events:none;z-index:0}
        @keyframes aFloat{0%,100%{transform:translate(0,0)}33%{transform:translate(10px,-16px)}66%{transform:translate(-8px,-24px)}}
        @keyframes aPulse{0%,100%{opacity:.03}50%{opacity:.07}}

        /* ==========================================
           RESPONSIVE
           ========================================== */
        @media(max-width:768px){
            body{cursor:auto}
            .cur-ring,.cur-dot,.cur-lbl{display:none!important}
            .card-face img{max-width:92vw;max-height:68vh}
            .nz{width:18%}
            .nz-btn{width:34px;height:34px;font-size:12px}
            .topbar{padding:0 16px;height:55px}
            .topbar .keys,.topbar .ctr{display:none}
            .topbar .brand{font-size:.5rem;letter-spacing:4px}
            .amb,.badge,.catlbl{display:none}
            .ft{width:30px;height:20px}
            .mm{display:none}
            .vp-container img{max-width:95vw;max-height:90vh}
        }
        @media(max-width:480px){
            .topbar .center{display:none}
            .film{gap:3px}.ft{width:24px;height:16px}
        }
    </style>
</head>
<body>

<div class="cur-ring" id="cR"></div>
<div class="cur-dot" id="cD"></div>
<div class="cur-lbl" id="cL"></div>

<div class="loader" id="loader">
    <h1>Gallery</h1>
    <div class="tag">a curated collection</div>
    <div class="track"><div class="fill" id="lFill"></div></div>
    <div class="pct" id="lPct">0%</div>
    <div class="cnt" id="lCnt">Loading images...</div>
</div>

<div class="intro" id="intro">
    <div class="big">The Gallery</div>
    <div class="sub" id="iSub">9 photographs</div>
    <div class="iline"></div>
    <button class="enter" id="iEnter">Enter Gallery</button>
</div>

<div class="flash" id="flash"></div>

<div class="amb tl"></div><div class="amb tr"></div><div class="amb bl"></div><div class="amb br"></div>

<div class="page-prog" id="pProg"></div>

<div class="topbar" id="topbar">
    <div class="brand">G A L L E R Y</div>
    <div class="center">
        <span class="title" id="tTitle"></span>
        <span class="cat" id="tCat"></span>
    </div>
    <div class="meta">
        <div class="keys">← → scroll | dbl-click to view | ? help</div>
        <div class="ctr" id="tCtr">1 / 9</div>
    </div>
</div>

<div class="stage" id="stage"><div class="scene" id="scene"></div></div>

<div class="nz l" id="nL"><div class="nz-btn">←</div></div>
<div class="nz r" id="nR"><div class="nz-btn">→</div></div>

<div class="badge" id="badge">
    <div class="badge-ln"></div>
    <div class="badge-n" id="bNum">1</div>
    <div class="badge-t" id="bTot">of 9</div>
    <div class="badge-ln"></div>
</div>

<div class="catlbl" id="catLbl">Anthony</div>

<div class="botbar" id="botbar">
    <div class="film" id="film"></div>
    <div class="dots" id="dots"></div>
</div>

<!-- ============ FULLSCREEN VIEWER ============ -->
<div class="viewer" id="viewer">
    <button class="viewer-close" id="vClose">✕</button>
    <div class="viewer-info">
        <div class="vi-title" id="viTitle"></div>
        <div class="vi-cat" id="viCat"></div>
    </div>
    <div class="vp" id="vp">
        <div class="vp-container" id="vpc">
            <img id="vpImg" src="" alt="" draggable="false">
        </div>
    </div>
    <div class="vz">
        <button id="vzOut">−</button>
        <div class="pct" id="vzPct">100%</div>
        <button id="vzIn">+</button>
        <div class="sep"></div>
        <button class="rst" id="vzRst">Reset</button>
    </div>
</div>

<div class="mm" id="mm">
    <img id="mmImg" src="" alt="" draggable="false">
    <div class="mm-vp" id="mmVp"></div>
</div>

<div class="help" id="help">
    <h2>Keyboard Shortcuts</h2>
    <div class="help-grid">
        <div class="help-k">← →</div><div class="help-d">Navigate slides</div>
        <div class="help-k">SCROLL</div><div class="help-d">Navigate slides</div>
        <div class="help-k">CLICK / ENTER</div><div class="help-d">Open full viewer</div>
        <div class="help-k">ESC</div><div class="help-d">Close viewer</div>
        <div class="help-k">+ −</div><div class="help-d">Zoom in / out (in viewer)</div>
        <div class="help-k">0</div><div class="help-d">Reset zoom</div>
        <div class="help-k">ARROWS</div><div class="help-d">Pan when zoomed</div>
        <div class="help-k">DBL CLICK</div><div class="help-d">Toggle 3× zoom</div>
        <div class="help-k">DRAG</div><div class="help-d">Pan when zoomed</div>
        <div class="help-k">SPACE</div><div class="help-d">Pulse effect</div>
        <div class="help-k">F</div><div class="help-d">Fullscreen</div>
        <div class="help-k">1-9</div><div class="help-d">Jump to slide</div>
        <div class="help-k">?</div><div class="help-d">This menu</div>
    </div>
    <button class="close" id="helpClose">Close</button>
</div>

<script>
/* ==================================================================
   DATA — organized by name
   ================================================================== */
const IMGS=[
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/bullyingpeopletype.png',title:'Bullying People Type',cat:'Bullying People Type'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/anthony1.jpg',title:'Anthony I',cat:'Anthony'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/anthony2.jpg',title:'Anthony II',cat:'Anthony'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/anthony3.jpg',title:'Anthony III',cat:'Anthony'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/saintlaurenceconfessions.jpg',title:'Confessions I',cat:'Saint Laurence'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/saintlaurenceconfessions2.jpg',title:'Confessions II',cat:'Saint Laurence'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/saintlaurenceconfessions3.jpg',title:'Confessions III',cat:'Saint Laurence'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/saintlaurenceconfessions4.jpg',title:'Confessions IV',cat:'Saint Laurence'},
    {src:'https://raw.githubusercontent.com/corrodedfridge-tech/heh/main/saintlaurenceconfessions5.jpg',title:'Confessions V',cat:'Saint Laurence'},
];
const N=IMGS.length;

/* ==================================================================
   STATE
   ================================================================== */
let cur=0,ready=false,helpOn=false,viewerOn=false;
let vZoom=1,vPanX=0,vPanY=0,vDrag=false,vDSX,vDSY,vPSX,vPSY;
let tiltX=0,tiltY=0;
let mx=0,my=0,crx=0,cry=0;
let wheelAcc=0,lastWheel=0;
const ZMIN=.5,ZMAX=12;

/* ==================================================================
   DOM
   ================================================================== */
const $=id=>document.getElementById(id);
const cR=$('cR'),cD=$('cD'),cL=$('cL');
const loader=$('loader'),lFill=$('lFill'),lPct=$('lPct'),lCnt=$('lCnt');
const intro=$('intro'),iEnter=$('iEnter'),iSub=$('iSub');
const flash=$('flash');
const topbar=$('topbar'),tTitle=$('tTitle'),tCat=$('tCat'),tCtr=$('tCtr');
const stage=$('stage'),scene=$('scene');
const nL=$('nL'),nR=$('nR');
const botbar=$('botbar'),film=$('film'),dots=$('dots');
const badge=$('badge'),bNum=$('bNum'),bTot=$('bTot');
const catLbl=$('catLbl'),pProg=$('pProg');
const viewer=$('viewer'),vClose=$('vClose'),vp=$('vp'),vpc=$('vpc'),vpImg=$('vpImg');
const vzPct=$('vzPct'),mm=$('mm'),mmImg=$('mmImg'),mmVp=$('mmVp');
const viTitle=$('viTitle'),viCat=$('viCat');
const help=$('help'),helpClose=$('helpClose');

/* ==================================================================
   CURSOR
   ================================================================== */
document.addEventListener('mousemove',e=>{
    mx=e.clientX;my=e.clientY;
    cD.style.left=mx+'px';cD.style.top=my+'px';
    cL.style.left=mx+'px';cL.style.top=my+'px';
    if(Math.random()>.85)spawnTrail(mx,my);
});
(function cLoop(){crx+=(mx-crx)*.13;cry+=(my-cry)*.13;cR.style.left=crx+'px';cR.style.top=cry+'px';requestAnimationFrame(cLoop)})();

function setCur(s){cR.className='cur-ring'+(s?' '+s:'')}
function setLbl(t){if(t){cL.textContent=t;cL.classList.add('on')}else cL.classList.remove('on')}
function hov(el,lbl){
    el.addEventListener('mouseenter',()=>{setCur('hov');if(lbl)setLbl(lbl)});
    el.addEventListener('mouseleave',()=>{setCur('');setLbl('')});
}
function spawnTrail(x,y){
    const t=document.createElement('div');t.className='trail';
    t.style.left=(x+(Math.random()-.5)*8)+'px';t.style.top=(y+(Math.random()-.5)*8)+'px';
    document.body.appendChild(t);setTimeout(()=>t.remove(),650);
}
document.addEventListener('click',e=>{
    const r=document.createElement('div');r.className='ripple';
    r.style.left=(e.clientX-90)+'px';r.style.top=(e.clientY-90)+'px';
    document.body.appendChild(r);setTimeout(()=>r.remove(),700);
});

/* ==================================================================
   LOADER
   ================================================================== */
let lp=0,lc=0;
IMGS.forEach(i=>{const img=new Image();img.onload=img.onerror=()=>{lc++;lCnt.textContent=lc+' of '+N+' loaded'};img.src=i.src});
setTimeout(()=>{
    const iv=setInterval(()=>{
        lp+=lc>=N?Math.random()*12+5:Math.random()*2+.6;
        if(lp>=100){lp=100;clearInterval(iv);lFill.style.width='100%';lPct.textContent='100%';lCnt.textContent='All '+N+' ready';
        setTimeout(()=>{loader.classList.add('done');setTimeout(showIntro,600)},700);return}
        lFill.style.width=Math.floor(lp)+'%';lPct.textContent=Math.floor(lp)+'%';
    },40);
},400);

/* ==================================================================
   INTRO
   ================================================================== */
function showIntro(){
    iSub.textContent=N+' photographs';
    intro.classList.add('on');
    hov(iEnter,'view');
    iEnter.addEventListener('click',()=>{intro.classList.remove('on');intro.classList.add('bye');setTimeout(startApp,800)});
    setTimeout(()=>{if(intro.classList.contains('on')&&!intro.classList.contains('bye'))iEnter.click()},7000);
}

/* ==================================================================
   START
   ================================================================== */
function startApp(){
    ready=true;buildSlides();buildFilm();buildDots();spawnAmb();
    go(0,false);
    stage.classList.add('on');topbar.classList.add('on');botbar.classList.add('on');badge.classList.add('on');catLbl.classList.add('on');
    bind();
}

/* ==================================================================
   BUILD
   ================================================================== */
function buildSlides(){
    IMGS.forEach((img,i)=>{
        const s=document.createElement('div');s.className='slide far';s.dataset.i=i;
        s.innerHTML=`<div class="card">
            <div class="cbr tl"></div><div class="cbr tr"></div><div class="cbr bl"></div><div class="cbr br"></div>
            <div class="card-face">
                <img src="${img.src}" alt="${img.title}" draggable="false">
                <div class="card-shine"></div><div class="card-spec"></div><div class="card-grad"></div>
            </div>
            <div class="card-lbl">${img.title}</div>
            <div class="card-num">${String(i+1).padStart(2,'0')}</div>
            <div class="card-shadow"></div>
        </div>`;
        scene.appendChild(s);
    });
}
function buildFilm(){
    IMGS.forEach((img,i)=>{
        const t=document.createElement('div');t.className='ft';
        t.innerHTML=`<img src="${img.src}" alt="" draggable="false">`;
        t.addEventListener('click',()=>go(i));hov(t,img.title.toLowerCase());
        film.appendChild(t);
    });
}
function buildDots(){
    IMGS.forEach((_,i)=>{
        const d=document.createElement('div');d.className='dot';
        d.addEventListener('click',()=>go(i));hov(d);
        dots.appendChild(d);
    });
}

/* ==================================================================
   GO TO SLIDE (carousel only, no zoom here)
   ================================================================== */
function go(i,anim=true){
    if(i<0)i=N-1;if(i>=N)i=0;
    if(anim&&i!==cur){flash.classList.add('go');setTimeout(()=>flash.classList.remove('go'),120)}
    cur=i;tiltX=0;tiltY=0;
    const slides=scene.querySelectorAll('.slide');
    slides.forEach((s,si)=>{
        s.className='slide';
        let d=si-cur;if(d>N/2)d-=N;if(d<-N/2)d+=N;
        const card=s.querySelector('.card');
        if(d===0){s.classList.add('active');s.style.transform='translateX(0) translateZ(0) rotateY(0)';card.style.transform='rotateX(0) rotateY(0)';card.style.transition='transform .12s ease-out'}
        else if(d===-1){s.classList.add('p1');s.style.transform='translateX(-78%) translateZ(-380px) rotateY(38deg)'}
        else if(d===1){s.classList.add('n1');s.style.transform='translateX(78%) translateZ(-380px) rotateY(-38deg)'}
        else if(d===-2){s.classList.add('p2');s.style.transform='translateX(-135%) translateZ(-650px) rotateY(48deg) scale(.8)'}
        else if(d===2){s.classList.add('n2');s.style.transform='translateX(135%) translateZ(-650px) rotateY(-48deg) scale(.8)'}
        else{s.classList.add('far');s.style.transform=`translateX(${d>0?200:-200}%) translateZ(-900px) scale(.5)`}
    });
    updateUI();
}

function updateUI(){
    const img=IMGS[cur];
    tCtr.textContent=(cur+1)+' / '+N;
    tTitle.textContent=img.title;tCat.textContent=img.cat;
    bNum.textContent=cur+1;bTot.textContent='of '+N;
    catLbl.textContent=img.cat;
    pProg.style.width=((cur+1)/N*100)+'%';
    dots.querySelectorAll('.dot').forEach((d,i)=>d.classList.toggle('on',i===cur));
    film.querySelectorAll('.ft').forEach((t,i)=>t.classList.toggle('on',i===cur));
}

/* ==================================================================
   3D TILT (carousel card)
   ================================================================== */
function doTilt(ex,ey){
    if(viewerOn)return;
    const as=scene.querySelector('.slide.active');if(!as)return;
    const card=as.querySelector('.card');
    const r=card.getBoundingClientRect();
    const inside=ex>=r.left&&ex<=r.right&&ey>=r.top&&ey<=r.bottom;
    if(inside){
        const nx=(ex-r.left)/r.width,ny=(ey-r.top)/r.height;
        tiltX=(ny-.5)*-16;tiltY=(nx-.5)*16;
        const sp=card.querySelector('.card-spec');
        if(sp){sp.style.setProperty('--sx',(nx*100)+'%');sp.style.setProperty('--sy',(ny*100)+'%')}
    }else{tiltX*=.9;tiltY*=.9}
    card.style.transform=`rotateX(${tiltX}deg) rotateY(${tiltY}deg)`;
    card.style.transition='transform .08s ease-out';
}
function resetTilt(){
    tiltX=0;tiltY=0;
    const as=scene.querySelector('.slide.active');if(!as)return;
    const card=as.querySelector('.card');
    card.style.transform='rotateX(0) rotateY(0)';
    card.style.transition='transform .7s var(--expo)';
}

/* ==================================================================
   OPEN VIEWER (fullscreen image view with zoom+pan)
   ================================================================== */
function openViewer(i){
    const img=IMGS[i];
    vpImg.src=img.src;mmImg.src=img.src;
    viTitle.textContent=img.title;viCat.textContent=img.cat;
    vZoom=1;vPanX=0;vPanY=0;
    applyVZoom(false);
    viewer.classList.add('on');
    viewerOn=true;
}
function closeViewer(){
    viewer.classList.remove('on');
    mm.classList.remove('on');
    viewerOn=false;
}

function applyVZoom(anim=true){
    if(anim){vpc.classList.add('anim');setTimeout(()=>vpc.classList.remove('anim'),450)}
    else vpc.classList.remove('anim');
    vpc.style.transform=`scale(${vZoom}) translate(${vPanX/vZoom}px,${vPanY/vZoom}px)`;
    vzPct.textContent=Math.round(vZoom*100)+'%';
    mm.classList.toggle('on',vZoom>1.08);
    if(vZoom>1.08)updateMM();
    setCur(vZoom>1.08?'zoom':'');
}

function clampVPan(){
    if(vZoom<=1){vPanX=0;vPanY=0;return}
    const iw=vpImg.naturalWidth,ih=vpImg.naturalHeight;
    const vr=vp.getBoundingClientRect();
    // figure displayed size
    const ar=iw/ih,vAr=vr.width/vr.height;
    let dw,dh;
    if(ar>vAr){dw=vr.width*.85;dh=dw/ar}else{dh=vr.height*.85;dw=dh*ar}
    // recalc with actual rendered
    const imgR=vpImg.getBoundingClientRect();
    dw=imgR.width/vZoom;dh=imgR.height/vZoom;

    const maxX=Math.max(0,(dw*vZoom-vr.width)/2+50);
    const maxY=Math.max(0,(dh*vZoom-vr.height)/2+50);
    vPanX=Math.max(-maxX,Math.min(maxX,vPanX));
    vPanY=Math.max(-maxY,Math.min(maxY,vPanY));
}

function updateMM(){
    if(vZoom<=1.08)return;
    const mw=mm.clientWidth,mh=mm.clientHeight;
    const vpW=Math.max(6,(1/vZoom)*mw),vpH=Math.max(6,(1/vZoom)*mh);
    const imgR=vpImg.getBoundingClientRect();
    const offX=-vPanX/(imgR.width)*mw;
    const offY=-vPanY/(imgR.height)*mh;
    const mx2=(mw-vpW)/2+offX,my2=(mh-vpH)/2+offY;
    mmVp.style.width=vpW+'px';mmVp.style.height=vpH+'px';
    mmVp.style.left=Math.max(0,Math.min(mw-vpW,mx2))+'px';
    mmVp.style.top=Math.max(0,Math.min(mh-vpH,my2))+'px';
}

/* ==================================================================
   BIND ALL EVENTS
   ================================================================== */
function bind(){

    // NAV ARROWS (slideshow)
    nL.addEventListener('click',()=>{if(!viewerOn)go(cur-1)});
    nR.addEventListener('click',()=>{if(!viewerOn)go(cur+1)});
    nL.addEventListener('mouseenter',()=>{setCur('nav');setLbl('prev')});
    nL.addEventListener('mouseleave',()=>{setCur('');setLbl('')});
    nR.addEventListener('mouseenter',()=>{setCur('nav');setLbl('next')});
    nR.addEventListener('mouseleave',()=>{setCur('');setLbl('')});

    // CLICK ACTIVE SLIDE → open viewer
    scene.addEventListener('click',e=>{
        if(viewerOn)return;
        const as=scene.querySelector('.slide.active');
        if(!as)return;
        const r=as.getBoundingClientRect();
        if(mx>=r.left&&mx<=r.right&&my>=r.top&&my<=r.bottom){
            openViewer(cur);
        }
    });

    // TILT on mousemove
    document.addEventListener('mousemove',e=>{
        if(!ready)return;
        if(!viewerOn&&!vDrag)doTilt(e.clientX,e.clientY);
        // parallax particles
        const px=(e.clientX/window.innerWidth-.5)*2,py=(e.clientY/window.innerHeight-.5)*2;
        document.querySelectorAll('.ap').forEach((p,i)=>{
            const s=(i%4+1)*1.8;p.style.marginLeft=px*s+'px';p.style.marginTop=py*s+'px';
        });
    });
    scene.addEventListener('mouseleave',()=>{if(!viewerOn)resetTilt()});

    // WHEEL: navigate slideshow when not in viewer
    document.addEventListener('wheel',e=>{
        if(!ready||helpOn)return;
        e.preventDefault();

        if(viewerOn){
            // zoom in viewer
            const d=-e.deltaY*.0025;
            const ns=Math.max(ZMIN,Math.min(ZMAX,vZoom*(1+d)));
            // zoom toward cursor
            const vpR=vp.getBoundingClientRect();
            const ox=mx-vpR.left-vpR.width/2;
            const oy=my-vpR.top-vpR.height/2;
            const f=ns/vZoom;
            vPanX=ox-f*(ox-vPanX);vPanY=oy-f*(oy-vPanY);
            vZoom=ns;clampVPan();applyVZoom(false);
            return;
        }

        // slideshow nav
        const now=Date.now();
        if(now-lastWheel>500)wheelAcc=0;
        lastWheel=now;wheelAcc+=e.deltaY;
        if(wheelAcc>60){go(cur+1);wheelAcc=0}
        else if(wheelAcc<-60){go(cur-1);wheelAcc=0}
    },{passive:false});

    // === VIEWER DRAG PAN ===
    vp.addEventListener('mousedown',e=>{
        if(e.button!==0||!viewerOn)return;
        if(vZoom<=1.08)return;
        vDrag=true;vDSX=e.clientX;vDSY=e.clientY;vPSX=vPanX;vPSY=vPanY;
        setCur('grab');
    });
    document.addEventListener('mousemove',e=>{
        if(!vDrag)return;
        vPanX=vPSX+(e.clientX-vDSX);vPanY=vPSY+(e.clientY-vDSY);
        clampVPan();applyVZoom(false);
    });
    document.addEventListener('mouseup',()=>{
        if(vDrag){vDrag=false;setCur(vZoom>1.08?'zoom':'');clampVPan();applyVZoom(true)}
    });

    // === VIEWER DOUBLE CLICK (zoom toggle) ===
    vp.addEventListener('dblclick',e=>{
        if(!viewerOn)return;
        if(vZoom>1.08){vZoom=1;vPanX=0;vPanY=0}
        else{
            const vpR=vp.getBoundingClientRect();
            const ox=e.clientX-vpR.left-vpR.width/2;
            const oy=e.clientY-vpR.top-vpR.height/2;
            vZoom=3;vPanX=-ox*2;vPanY=-oy*2;clampVPan();
        }
        applyVZoom(true);
    });

    // === VIEWER TOUCH ===
    let ltd=0,ltc={x:0,y:0},tst=0,tsx=0;
    vp.addEventListener('touchstart',e=>{
        if(!viewerOn)return;
        if(e.touches.length===1){
            tst=Date.now();tsx=e.touches[0].clientX;
            if(vZoom>1.08){vDrag=true;vDSX=e.touches[0].clientX;vDSY=e.touches[0].clientY;vPSX=vPanX;vPSY=vPanY}
        }else if(e.touches.length===2){
            vDrag=false;
            const dx=e.touches[0].clientX-e.touches[1].clientX,dy=e.touches[0].clientY-e.touches[1].clientY;
            ltd=Math.sqrt(dx*dx+dy*dy);
            ltc={x:(e.touches[0].clientX+e.touches[1].clientX)/2,y:(e.touches[0].clientY+e.touches[1].clientY)/2};
        }
    },{passive:false});

    vp.addEventListener('touchmove',e=>{
        if(!viewerOn)return;e.preventDefault();
        if(e.touches.length===1&&vDrag){
            vPanX=vPSX+(e.touches[0].clientX-vDSX);vPanY=vPSY+(e.touches[0].clientY-vDSY);
            clampVPan();applyVZoom(false);
        }else if(e.touches.length===2){
            const dx=e.touches[0].clientX-e.touches[1].clientX,dy=e.touches[0].clientY-e.touches[1].clientY;
            const dist=Math.sqrt(dx*dx+dy*dy);
            const c={x:(e.touches[0].clientX+e.touches[1].clientX)/2,y:(e.touches[0].clientY+e.touches[1].clientY)/2};
            if(ltd>0){
                const f=dist/ltd;vZoom=Math.max(ZMIN,Math.min(ZMAX,vZoom*f));
                vPanX+=(c.x-ltc.x);vPanY+=(c.y-ltc.y);clampVPan();applyVZoom(false);
            }
            ltd=dist;ltc=c;
        }
    },{passive:false});

    vp.addEventListener('touchend',e=>{
        if(e.touches.length<2)ltd=0;
        // swipe to navigate in viewer at 1x
        if(vDrag&&vZoom<=1.08){
            const el=Date.now()-tst,dx=e.changedTouches[0].clientX-tsx;
            if(el<350&&Math.abs(dx)>45){
                closeViewer();
                setTimeout(()=>{if(dx>0)go(cur-1);else go(cur+1);},200);
            }
        }
        vDrag=false;clampVPan();applyVZoom(true);
    });

    // swipe on slideshow (not viewer)
    let sTST=0,sTSX=0;
    scene.addEventListener('touchstart',e=>{
        if(viewerOn||!ready)return;
        sTST=Date.now();sTSX=e.touches[0].clientX;
    });
    scene.addEventListener('touchend',e=>{
        if(viewerOn||!ready)return;
        const el=Date.now()-sTST,dx=e.changedTouches[0].clientX-sTSX;
        if(el<400&&Math.abs(dx)>40){if(dx>0)go(cur-1);else go(cur+1)}
    });

    // CLOSE VIEWER
    vClose.addEventListener('click',closeViewer);
    hov(vClose,'close');
    viewer.addEventListener('click',e=>{if(e.target===viewer)closeViewer()});

    // ZOOM HUD
    $('vzIn').addEventListener('click',()=>{vZoom=Math.min(ZMAX,vZoom*1.5);clampVPan();applyVZoom(true)});
    $('vzOut').addEventListener('click',()=>{vZoom=Math.max(ZMIN,vZoom/1.5);clampVPan();applyVZoom(true)});
    $('vzRst').addEventListener('click',()=>{vZoom=1;vPanX=0;vPanY=0;applyVZoom(true)});
    document.querySelectorAll('.vz button').forEach(b=>hov(b));

    // HELP
    helpClose.addEventListener('click',()=>{helpOn=false;help.classList.remove('on')});
    hov(helpClose,'close');

    // === KEYBOARD ===
    document.addEventListener('keydown',e=>{
        if(!ready)return;

        // help toggle
        if(e.key==='?'||(e.key==='/'&&e.shiftKey)){helpOn=!helpOn;help.classList.toggle('on',helpOn);return}
        if(helpOn){if(e.code==='Escape'){helpOn=false;help.classList.remove('on')};return}

        // viewer open
        if(!viewerOn){
            switch(e.code){
                case'ArrowLeft':e.preventDefault();go(cur-1);break;
                case'ArrowRight':e.preventDefault();go(cur+1);break;
                case'Enter':case'Space':e.preventDefault();
                    if(e.code==='Space')pulseEffect();else openViewer(cur);break;
                case'KeyF':e.preventDefault();togFS();break;
            }
            if(e.key>='1'&&e.key<='9'){const idx=parseInt(e.key)-1;if(idx<N)go(idx)}
            return;
        }

        // viewer controls
        switch(e.code){
            case'Escape':closeViewer();break;
            case'ArrowLeft':e.preventDefault();
                if(vZoom>1.08){vPanX+=80;clampVPan();applyVZoom(true)}
                else{closeViewer();setTimeout(()=>go(cur-1),150)}
                break;
            case'ArrowRight':e.preventDefault();
                if(vZoom>1.08){vPanX-=80;clampVPan();applyVZoom(true)}
                else{closeViewer();setTimeout(()=>go(cur+1),150)}
                break;
            case'ArrowUp':e.preventDefault();if(vZoom>1.08){vPanY+=80;clampVPan();applyVZoom(true)};break;
            case'ArrowDown':e.preventDefault();if(vZoom>1.08){vPanY-=80;clampVPan();applyVZoom(true)};break;
            case'Equal':case'NumpadAdd':e.preventDefault();vZoom=Math.min(ZMAX,vZoom*1.35);clampVPan();applyVZoom(true);break;
            case'Minus':case'NumpadSubtract':e.preventDefault();vZoom=Math.max(ZMIN,vZoom/1.35);clampVPan();applyVZoom(true);break;
            case'Digit0':vZoom=1;vPanX=0;vPanY=0;applyVZoom(true);break;
            case'Space':e.preventDefault();pulseEffect();break;
            case'KeyF':e.preventDefault();togFS();break;
        }
    });
}

/* ==================================================================
   EFFECTS
   ================================================================== */
function pulseEffect(){
    const as=scene.querySelector('.slide.active');if(!as)return;
    const card=as.querySelector('.card');
    card.style.transition='transform .35s var(--spring)';
    card.style.transform=`rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(1.06)`;
    setTimeout(()=>{card.style.transform=`rotateX(${tiltX}deg) rotateY(${tiltY}deg) scale(1)`},350);
    const r=card.getBoundingClientRect();
    for(let i=0;i<25;i++)setTimeout(()=>spawnTrail(r.left+r.width/2+(Math.random()-.5)*r.width,r.top+r.height/2+(Math.random()-.5)*r.height),i*18);
}

function togFS(){
    if(!document.fullscreenElement)document.documentElement.requestFullscreen().catch(()=>{});
    else document.exitFullscreen();
}

/* ==================================================================
   AMBIENT
   ================================================================== */
function spawnAmb(){
    for(let i=0;i<25;i++){
        const p=document.createElement('div');p.className='ap';
        p.style.left=Math.random()*100+'vw';p.style.top=Math.random()*100+'vh';
        p.style.animation=`aFloat ${9+Math.random()*15}s ease-in-out infinite,aPulse ${3+Math.random()*5}s ease-in-out infinite`;
        p.style.animationDelay=Math.random()*6+'s';
        document.body.appendChild(p);
    }
}

/* ==================================================================
   CLOCK
   ================================================================== */
const clk=document.createElement('div');
clk.style.cssText='position:fixed;bottom:8px;right:12px;z-index:200;font-family:Inter,sans-serif;font-size:.38rem;letter-spacing:3px;color:rgba(0,0,0,.07);font-variant-numeric:tabular-nums;pointer-events:none';
document.body.appendChild(clk);
setInterval(()=>{const n=new Date();clk.textContent=n.toLocaleTimeString('en-US',{hour12:false})+' · '+n.toLocaleDateString('en-US',{month:'short',day:'numeric'})},1000);

/* ==================================================================
   IDLE AUTOPLAY
   ================================================================== */
let idleT=null,autoI=null;
function resetIdle(){
    clearTimeout(idleT);clearInterval(autoI);autoI=null;
    idleT=setTimeout(()=>{autoI=setInterval(()=>{if(!viewerOn&&!helpOn)go(cur+1)},4500)},25000);
}
['mousemove','click','keydown','wheel','touchstart'].forEach(ev=>document.addEventListener(ev,resetIdle));
</script>
</body>
</html>
